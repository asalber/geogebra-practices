% !TEX root = ../geogebra-practices.tex
% Author: Alfredo Sánchez Alberca (asalber@ceu.es)
\chapter{Several variables differentiable calculus}

% \section{Fundamentos teóricos}
% El concepto de derivada es uno de los más importantes del Cálculo
% pues resulta de gran utilidad en el estudio de funciones y tiene
% multitud de aplicaciones. En esta práctica introducimos este
% concepto de derivada parcial en funciones de varias variables y presentamos algunas de sus aplicaciones.

% \subsection{partial derivatives de una función de $n$ variables}
% Recordemos que the derivative of una función de una única variable en
% un punto $x=a$ se define como la tasa de variación instantánea de la
% función en dicho punto. Si llamamos $h$ al incremento en la
% variable, the derivative of la función en $x=a$ se nota como $f'(a)$ ó
% $\dfrac{{df}} {{dx}}(a)$, y se calcula como:

% \[
% f'(a) = \frac{df}{dx}(a) = \mathop {\lim
% }\limits_{h \to 0} \frac{{f(a + h) - f(a)}} {h}
% \]

% Y, en general, para cualquier $x$ en un conjunto en el que la
% función de una única variable sea derivable, puede definirse la
% función derivada $f'(x)$ ó $\dfrac{df}{dx}$,
% mediante the limit:

% \[
% f'(x) = \frac{df}{dx} = \mathop {\lim }\limits_{h
% \to 0} \frac{{f(x + h) - f(x)}} {h}
% \]
% que, no obstante, se calcula aplicando las adecuadas reglas de
% derivación, más bien que acudiendo a la resolución directa del
% límite.

% De igual forma, si tenemos una función de $n$ variables
% $f(\vec{x})=f(x_1,x_2,...,x_n)$, se pueden definir esas mismas tasas
% de variación instantáneas with respect to cada una de las variables
% en un punto $\vec{a}=(a_1,a_2,...,a_n)$, para obtener las
% \emph{partial derivatives} de la función with respect to cada una de
% las variables en el punto $\vec{x}=\vec{a}$, que se notarán como
% $f_{x_i}(\vec{a})$, o bien por $\dfrac{\partial f}{\partial
% x_i}(\vec{a})$:

% \[
% f_{x_i}(\vec{a})=\dfrac{\partial f}{\partial
% x_i}(\vec{a})=\lim_{h\rightarrow
% 0}\frac{f(a_1,\ldots,a_i+h,\ldots,a_n)-f(a_1,\ldots,a_i,\ldots,a_n)}{h},
% \]

% Y la \emph{Función Derivada Parcial} with respect to cualquiera de
% las variables $x_i$, para todos los $\vec{x}$ de un conjunto, que se
% notará como $f_{x_i}$, o $\dfrac{\partial f}{\partial x_i}$:

% \[
% f_{x_i}=\dfrac{\partial f}{\partial x_i}=\lim_{h\rightarrow
% 0}\frac{f(x_1,\ldots,x_i+h,\ldots,x_n)-f(x_1,\ldots,x_i,\ldots,x_n)}{h},
% \]

% Lo cual, a efectos de cálculo, se resume en que the partial derivative
% de una función de varias variables se obtiene como la derivada de
% una función de una única variable, que es aquella with respect to la
% que se deriva, y constantes el resto. Como consecuencia, las reglas
% de derivación también se aplican en el cálculo de las derivadas
% parciales de este tipo de funciones, sin más que considerar
% constantes todas las variables with respect to las que no estamos
% derivando.

% Si para las funciones de una variable la derivada en un punto $a$
% tiene una interpretación gráfica sencilla como la pendiente de la
% recta tangente a la gráfica de la función en el punto $(a,f(a))$,
% también para funciones de dos variables the partial derivative con
% respecto a $x$ en el punto $\vec{a}=(x_0,y_0)$:

% \[
% \frac{{\partial f}} {{\partial x}}(x_0 ,y_0 ) = \mathop {\lim
% }\limits_{h \to 0} \frac{{f(x_0  + h,y_0 ) - f(x_0 ,y_0 )}} {h}
% \]
% representa la pendiente de la recta tangente a la curva que se
% obtiene al cortar la gráfica de la función en el punto
% $(x_0,y_0,z_0=f(x_0,y_0))$ mediante el plano en el que $y$ permanece
% constante e igual a $y_0$, y tan sólo varía el valor de $x$. E
% igualmente, the partial derivative with respect to $y$ será la pendiente
% de la recta tangente a la curva que se obtiene al cortar la gráfica
% de la función en $(x_0,y_0,z_0=f(x_0,y_0))$ mediante el plano
% $x=x_0$.

% \begin{figure}[h!]
% \begin{center}
% \includegraphics[scale=0.4]{img/derivadas_varias_variables/tangentesuperficie}
% \caption{the partial derivative de una función $f(x,y)$ with respect to
% $x$ en el punto $(x_0,y_0)$, como la pendiente de la recta tangente
% a la curva descrita por la intersección de la superficie de $f$ y el
% plano de ecuación $y=y_0$.}
% \end{center}
% \end{figure}


% \subsection{partial derivatives sucesivas de una función de $n$
% variables}

% De la misma forma que en las funciones de una variable, mediante los
% límites que las definen, siempre y cuando existan, obtenemos las
% segundas, terceras y derivadas de cualquier orden. Es decir, si $f$
% es una función real de $n$ variables, con sus correspondientes
% partial derivatives, a su vez también las mismas son funciones de
% $n$ variables que, en determinadas condiciones, podrán derivarse de
% nuevo with respect to sus $n$ variables para obtener derivadas
% parciales segundas, y así sucesivamente hasta órdenes superiores de
% derivación.

% Para the second order partial derivative se utiliza la notación
% $f_{x_ix_j}$ ó $\dfrac{{\partial ^2 f}} {{\partial x_j \partial x_i
% }}$:


% \[
% f_{x_i x_j }  = \frac{{\partial ^2 f}} {{\partial x_j \partial x_i
% }} = \frac{\partial } {{\partial x_j }}\left( {\frac{{\partial f}}
% {{\partial x_i }}} \right)
% \]

% Por ejemplo, para una función de dos variables $f(x,y)$, tenemos dos partial derivatives de primer orden, que siguen
% siendo funciones de las variables $x$ e $y$:
% \[
% \frac{\partial f}{\partial x}(x,y)\qquad \frac{\partial f}{\partial y}(x,y) 
% \] y cuatro diferentes de segundo orden, que también serán funciones de $x$ e $y$, aunque ya no se
% refleje para aligerar la notación:
% \[
% \frac{\partial}{\partial x}\left({\frac{\partial f}{\partial x}}\right) = \frac{\partial^2 f}{\partial x^2}
% \]
% \[
% \frac{\partial}{\partial y}\left({\frac{\partial f}{\partial x}}\right) = \frac{\partial^2 f}{\partial y\partial x}
% \]
% \[
% \frac{\partial}{\partial x}\left({\frac{\partial f}{\partial y}}\right) = \frac{\partial^2 f}{\partial x\partial y}
% \]
% \[
% \frac{\partial}{\partial y}\left({\frac{\partial f}{\partial y}}\right) = \frac{\partial^2 f}{\partial y^2}
% \]

% La primera y la última reciben el nombre de derivadas segundas, mientras que la segunda y tercera se denominan derivadas
% cruzadas.

% Si procedemos con las partial derivatives de tercer orden tendríamos ocho diferentes, y el número es más amplio con
% funciones de tres o más variables.
% No obstante, el teorema conocido con \emph{Teorema de Schwartz de las Derivadas Cruzadas} reduce el número de derivadas
% parciales diferentes:

% \begin{teorema}[Schwartz]
% Si $f$ es una función de $n$ variables con partial derivatives segundas cruzadas continuas en un conjunto abierto que
% contiene al punto $a$, entonces en dicho punto se cumple
% \[
% \frac{\partial ^2 f}{\partial x_i \partial x_j } = \frac{\partial ^2 f}{\partial x_j \partial x_i }
% \] 
% e igual con las derivadas cruzadas de tercer y superior orden.
% \end{teorema}

% Es decir, si se cumplen las hipótesis del teorema de Schwartz concluimos que, a efectos de cálculo, tan sólo importa el
% número de veces que se deriva respecto a cada variable, pero no el orden de la derivación.

% \subsection{Vector gradiente y matriz hessiana}
% A partir de las partial derivatives de primer orden de un campo escalar, podemos definir el siguiente vector:

% \begin{definicion}[Vector gradiente]
% Dado un campo escalar $f(x_1,\ldots,x_n)$, se llama \emph{gradiente} de $f$, y se escribe $\nabla f$, a la función que a
% cada punto $a=(a_1,\ldots,a_n)$ le asigna el vector cuyas coordenadas cartesianas son las partial derivatives de $f$ en
% $a$,
% \[
% \nabla f(a)=\left(\frac{\partial f}{\partial x_1}(a),\ldots,\frac{\partial f}{\partial x_n}(a)\right).
% \]
% \end{definicion}

% El vector gradiente en un punto dado tiene la misma magnitud y dirección que la velocidad máxima de variación de la
% función en ese punto, por lo que $\nabla f(a)$ indica la dirección de máximo crecimiento de $f$ en el punto $a$,
% mientras que $-\nabla f(a)$ indica la dirección de máximo decrecimiento.

% Y a partir de las partial derivatives de segundo orden, podemos definir la siguiente matriz:

% \begin{definicion}[Matriz hessiana]
% Dada una función de varias variables $f(x_1,\ldots,x_n)$, para la que existen todas sus partial derivatives de segundo
% orden en un punto $a=(a_1,\ldots,a_n)$, se define la \emph{matriz hessiana} de $f$ en $a$, y se nota $\nabla^2f(a)$, como la
% matriz cuadrada cuyos elementos son
% \[
% \nabla^2f(a)=\left(
% \begin{array}{cccc}
% \dfrac{\partial^2 f}{\partial x_1^2}(a) & 
% \dfrac{\partial^2 f}{\partial x_1 \partial x_2}(a) &
% \cdots &
% \dfrac{\partial^2 f}{\partial x_1 \partial x_n}(a)\\
% \dfrac{\partial^2 f}{\partial x_2 \partial x_1}(a) &
% \dfrac{\partial^2 f}{\partial x_2^2}(a) & 
% \cdots &
% \dfrac{\partial^2 f}{\partial x_2 \partial x_n}(a)\\
% \vdots & \vdots & \ddots & \vdots \\
% \dfrac{\partial^2 f}{\partial x_n \partial x_1}(a) &
% \dfrac{\partial^2 f}{\partial x_n \partial x_2}(a) &
% \cdots &
% \dfrac{\partial^2 f}{\partial x_n^2}(a)
% \end{array}
% \right).
% \]
% Al determinante de esta matriz se le llama \emph{hessiano} de $f$ en $a$, y se nota $Hf(a)=|\nabla^2f(a)|$.
% \end{definicion}

% Entre las utilidades de the Hessian matrix y el hessiano está la determinación de los extremos relativos y los puntos de
% silla de una función. 

% \subsection{Derivada direccional}
% Ya se ha visto que la partial derivatives miden la tasa de variación instantánea de la función with respect to cada uno
% de sus variables, es decir, en la dirección de cada uno de los ejes de coordenadas. 
% Pero, \emph {¿qué pasa si nos movemos en cualquier otra dirección?}
% La tasa de variación instantánea de $f$ en un punto $a$ en la dirección de un vector unitario cualquiera $u$ se conoce
% como \emph{derivada direccional}.

% \begin{definicion}[Derivada direccional]
% Dado un campo escalar $f$ de $\mathbb{R}^n$, un punto $a$ y un vector unitario $\mathbf{u}$ en ese espacio, the limit
% \[
% f'_{\mathbf{u}}(a) = \lim_{h\rightarrow 0}\frac{f(a+h\mathbf{u})-f(a)}{h},
% \] 
% cuando existe, se llama \emph{derivada direccional} de $f$ en el punto $a$ en la dirección de $\mathbf{u}$.
% \end{definicion}
% Se cumple 
% \[
% f'_{\mathbf{u}}(a) =\nabla f(a)\cdot \mathbf{u}.
% \]
% Obsérvese que las partial derivatives son las derivadas direccionales en las direcciones de los vectores coordenados.

% \subsection{Derivación implícita}
% Si se sabe que la ecuación 
% \[
% f(x,y)=0
% \]
% define a $y$ como función de $x$, $y=h(x)$, alrededor de cierto valor $x=x_0$ para el que $y=h(x_0)=y_0$, entonces, si se toma la trayectoria $g(x)=(x,h(x))$, la ecuación anterior se puede expresar como
% \[
% (f\circ g)(x) = f(g(x)) = f(x,h(x))=0,
% \]
% de modo que usando la regla de la cadena sobre se tiene
% \[
% (f\circ g)'(x) = \nabla f(g(x))\cdot g'(x) = \left(\frac{\partial f}{\partial x}, \frac{\partial f}{\partial y}\right)\cdot (1,h'(x)) = 
% \frac{\partial f}{\partial x}+\frac{\partial f}{\partial y}h'(x) = 0,
% \] 
% de donde se deduce
% \[
% y'=h'(x)=\frac{-\dfrac{\partial f}{\partial x}}{\dfrac{\partial f}{\partial y}}
% \]

% \subsection{Cálculo de extremos}
% Si $a$ es un extremo de un campo escalar $f$ de $\mathbb{R}^n$, entonces se cumple que $a$ es un punto crítico de $f$,
% es decir,
% \[
% \nabla f(P) = 0,
% \]
% Sin embargo, no todos los puntos críticos son extremos relativos. 
% Existen puntos como el de la figura~\ref{g:punto_silla} donde se anula el gradiente y que no son puntos de máximo, ni de
% mínimo.
% Estos puntos se conocen como \emph{puntos de silla}. 
% \begin{figure}[htp]
% \begin{center}
% \scalebox{1}{\input{img/derivadas_varias_variables/punto_silla}}.
% \caption{Gráfica de la función $f(x,y)=x^2-y^2$, que tiene un punto de silla en $(0,0)$. }
% \label{g:punto_silla}
% \end{center}
% \end{figure}

% Afortunadamente, es posible determinar si un punto crítico es un extremo relativo o un punto de silla a partir de la
% matriz Hessiana y el hessiano. 

% \begin{teorema}
% Dado un punto crítico $a$ de un campo escalar $f$ que tiene matríz hessiana $Hf(a)$, se cumple
% \begin{itemize}
% \item Si $\nabla^2f(a)$ es definido positivo entonces $f$ tiene un mínimo relativo en $a$.
% \item Si $\nabla^2f(a)$ es definido negativo entonces $f$ tiene un máximo relativo en $a$.
% \item Si $\nabla^2f(a)$ es indefinido entonces $f$ tiene un punto de silla en $a$.
% \end{itemize}
% \end{teorema}
% En el caso de que $\nabla^2f(a)$ sea semidefinido, no se puede obtener ninguna conclusión y hay que recurrir a derivadas
% parciales de orden superior.

% En el caso particular de un campo escalar de dos variables se tiene
% \begin{teorema}
% Dado un punto crítico $a=(x_0,y_0)$ de un campo escalar $f(x,y)$ que tiene matríz hessiana $\nabla^2f(a)$, se cumple
% \begin{itemize}
% \item Si $Hf(a)>0$ y $\dfrac{\partial^2 f}{\partial x^2}(a)>0$ entonces $f$ tiene un mínimo relativo en $a$.
% \item Si $Hf(a)>0$ y $\dfrac{\partial^2 f}{\partial x^2}(a)<0$ entonces $f$ tiene un máximo relativo en $a$.
% \item Si $Hf(a)<0$ entonces $f$ tiene un punto de silla en $a$.
% \end{itemize}
% \end{teorema}

% \newpage

\section{Solved exercises}
\begin{enumerate}[leftmargin=*]
\item Compute the tangent line and the normal plane to the trajectory of
      \[
      f(t)=
      \begin{cases}
      x=\sin(t), \\
      y=\cos(t), \\
      z=\sqrt(t),
      \end{cases}
      \quad t\in \mathbb{R};
      \]
      at the time $t=\pi$ and plot them.

      \begin{indication}
      \begin{enumerate}
      \item Enter the command \command{f(t):=(sin(t),cos(t),sqrt(t))} in the \field{Input Bar} of the \field{CAS View} and activate the \field{3D Graphics View}.
      \item To plot the point of tangency in the trajectory, enter the command \command{f(pi)} in the \field{Input Bar} and click the circle to the left of this expression.
      \item To compute and plot the tangent line to the trajectory, enter the command \command{g(t):=f(pi)+f'(pi)t} in the \field{Input Bar}.
      \item To compute the normal plane to the trajectory, enter the command \command{((x,y,z)-f(pi))f'(pi)=0} in the \field{Input Bar}.
      \item To plot the normal plane to the trajectory, click the circle to the left of the previous expression.
      \end{enumerate}
      \end{indication}

\item Given the function $f(x,y)=y^2-x^2$,
      \begin{enumerate}
      \item Plot its graph and the point $(1,2,f(1,2))$.
            \begin{indication}
            \begin{enumerate}
            \item Enter the function \command{f(x,y):=y\^{}2-x\^{}2} in the \field{Input Bar} of the \field{CAS View} and activate the \field{3D Graphics View}.
            \item Enter the point \command{(1,2,f(1,2))} in the \field{Input Bar} and click the circle to the left of this expression.
            \end{enumerate}
            \end{indication}

            % \item Dibujar las curvas de nivel $f(x,y)=k$, para valores enteros de $k$ desde 1 hasta 5.
            % \begin{indication}
            % \begin{enumerate}
            % \item Introducir la ecuación \command{f(x,y)=k} para cada valor de $k$.
            % \item Hacer clic sobre el botón \button{Ventana 2D} para pasar a la ventana de gráficas 2D.
            % \item Hacer clic sobre el botón \button{Representar Expresión}).
            % \end{enumerate}
            % \end{indication}

      \item  Plot the plane with equation $x=1$.
            What shape has the curve that results from the intersection of this plane and the graph of $f$?

            \begin{indication}
            Enter the command \command{x=1} in the \field{Input Bar} and click the circle to the left of this expression.
            \end{indication}

      \item Compute the derivative of $f(1,y)$ at $y=2$.
            \begin{indication}
            \begin{enumerate}
            \item Enter the command \command{Derivative(f(1,y))} in the \field{Input Bar}.
            \item Enter the command \command{Substitute(\$, y=2)} in the \field{Input Bar}.
            \end{enumerate}
            \end{indication}

      \item Plot the plane with equation $y=2$.
            What shape has the curve that results from the intersection of this plane and the graph of $f$?
            \begin{indication}
            Enter the command \command{y=2} in the \field{Input Bar} and click the circle to the left of this expression.
            \end{indication}

      \item Compute la derivative of $f(x,2)$ at $x=1$.
            \begin{indication}
            \begin{enumerate}
            \item Enter the command \command{Derivative(f(x,2))} in the \field{Input Bar}.
            \item Enter the command \command{Substitute(\$, x=1)} in the \field{Input Bar}.
            \end{enumerate}
            \end{indication}

      \item Compute the partial derivatives of $f$ at the point $(1,2)$.
            What conclusions can you draw?
            \begin{indication}
            \begin{enumerate}
            \item To compute the partial derivative with respect to $x$, enter the command \command{f'\_x(x,y):=Derivative(f, x)} in the \field{Input Bar}.
            \item To compute the value of the partial derivative with respect to $x$ at the point $(1,2)$, enter the function \command{f'\_x(1,2)} in the \field{Input Bar}.
            \item To compute the partial derivative with respect to  $y$, enter the command \command{f'\_y(x,y):=Derivative(f, y)} in the \field{Input Bar}.
            \item To compute the value of the partial derivative with respect to $y$ at the point $(1,2)$, enter the function \command{f'\_y(1,2)} in the \field{Input Bar}.
            \end{enumerate}
            \end{indication}
      \end{enumerate}


\item Compute the following partial derivatives:
      \begin{enumerate}
      \item  $\dfrac{\partial }{\partial V}\dfrac{nRT}{V}.$
            \begin{indication}
            Enter the command \command{Derivative(nRT/V, V)} in the \field{Input Bar} of the \field{CAS View}.
            \end{indication}

      \item  $\dfrac{\partial ^{2}}{\partial x\partial y}e^{x+y}\sin(x/y).$
            \begin{indication}
            Enter the command \command{Derivative(Derivative(e\^{}(x+y)sen(x/y), y), x)} in the \field{Input Bar}.
            \end{indication}
      \end{enumerate}


\item Given the function $f(x,y)=20-4x^2-y^2$, compute at the point $(2,-3)$:
      \begin{enumerate}
      \item Gradient.
            \begin{indication}
            \begin{enumerate}
            \item Enter the function \command{f(x,y):=20-4x\^{}2-y\^{}2} in the \field{Input Bar} of the \field{CAS View}.
            \item To compute the partial derivative with respect to $x$, enter the command \command{f'\_x(x,y):=Derivative(f, x)} in the \field{Input Bar}.
            \item To compute the partial derivative with respect to $y$, enter the command \command{f'\_y(x,y):=Derivative(f, y)} in the \field{Input Bar}.
            \item To compute the gradient, enter the command \command{f'(x,y):=(f'\_x, f'\_y)} in the \field{Input Bar}.
            \item To compute the gradient at the point $(2,-3)$, enter the function \command{f'(2,-3)}.
            \end{enumerate}
            \end{indication}

      \item Hessian matrix.
            \begin{indication}
            \begin{enumerate}
            \item To compute the second order partial derivative $\frac{\partial\^2 f}{\partial x^2}$, enter the command \command{f''\_\{xx\}(x,y):= Derivative(f'\_x, x)} in the \field{Input Bar}.
            \item To compute the second order partial derivative $\frac{\partial\^2 f}{\partial y\partial x}$, enter the command \command{f''\_\{xy\}(x,y):= Derivative(f'\_x, y)} in the \field{Input Bar}.
            \item To compute the second order partial derivative $\frac{\partial\^2 f}{\partial x\partial y}$, enter the command \command{f''\_\{yx\}(x,y):= Derivative(f'\_y, x)} in the \field{Input Bar}.
            \item To compute the second order partial derivative $\frac{\partial\^2 f}{\partial y^2}$, enter the command \command{f''\_\{yy\}(x,y):= Derivative(f'\_y, y)} in the \field{Input Bar}.
            \item To compute the Hessian matrix, enter the command \command{f''(x,y):=\{\{f''\_\{xx\}, f''\_\{yx\}\}, \{f''\_\{xy\}, f''\_\{yy\}\}\}} in the \field{Input Bar}.
            \item To compute the Hessian matrix at the point $(2,-3)$, enter the function \command{f''(2,-3)} in the \field{Input Bar}.
            \end{enumerate}
            \end{indication}

      \item Hessian.
            \begin{indication}
            Enter the command \command{Determinant(\$)} in the \field{Input Bar}.
            \end{indication}
      \end{enumerate}


      % \item Given the function
      % \[
      % f(x,y,z)=\sin((x^2-y^2)z)
      % \]
      % \begin{enumerate}
      % \item Definir la función.
      % \begin{indication}
      % Introducir la expresión \command{f(x,y,z):=sin((x\^{}2-y\^{}2)z)}.
      % \end{indication}
      % 
      % \item Calcular su vector gradiente en el punto $(0,-1,\pi/2)$.
      % \begin{indication}
      % \begin{enumerate}
      % \item Introducir la expresión \command{f'(0,-1,pi/2)}.
      % \item Hacer clic sobre el botón \button{Simplificar}.
      % \end{enumerate}
      % \end{indication}
      % 
      % \item Calcular su matriz Hessiana en el punto $(0,-1,\pi/2)$.
      % \begin{indication}
      % \begin{enumerate}
      % \item Introducir la expresión \command{f''(0,-1,pi/2)}.
      % \item Hacer clic sobre el botón \button{Simplificar}.
      % \end{enumerate}
      % \end{indication}
      % 
      % \item Comprobar que se cumple el teorema Schwartz de las derivadas para las derivas cruzadas:
      % \begin{enumerate}
      % \item $\dfrac{{\partial ^3 f}} {{\partial x\partial z\partial y}}$
      % \begin{indication}
      % \begin{enumerate}
      % \item Introducir la expresión \command{f(x,y,z)}.
      % \item Hacer clic sobre el botón \button{Hallar una derivada}.
      % \item En el cuadro de diálogo que aparece seleccionar la variable $y$ y hacer clic en el botón \button{Simplificar}.
      % \item Repetir el proceso con la expresión resultante, seleccionando esta vez la variables $z$.
      % \item Repetir una vez más el proceso con la expresión resultante, seleccionando esta vez la variables $x$.
      % \end{enumerate}
      % \end{indication}
      % 
      % \item $\dfrac{{\partial ^3 f}} {{\partial z\partial x\partial y}}$
      % \begin{indication}
      % \begin{enumerate}
      % \item Introducir la expresión \command{f(x,y,z)}.
      % \item Hacer clic sobre el botón \button{Hallar una derivada}.
      % \item En el cuadro de diálogo que aparece seleccionar la variable $y$ y hacer clic en el botón \button{Simplificar}.
      % \item Repetir el proceso con la expresión resultante, seleccionando esta vez la variables $x$.
      % \item Repetir una vez más el proceso con la expresión resultante, seleccionando esta vez la variables $z$.
      % \end{enumerate}
      % \end{indication}
      % \end{enumerate}
      % 
      % ¿Puedes predecir el valor de $\dfrac{{\partial ^3 f}} {{\partial y\partial x\partial z}}$?
      % \end{enumerate}

\item Compute the normal line and the tangent plane to the surface $S: x+2y-\log z +4 =0$ at the point $(0,-2,1)$ and plot them.
      \begin{indication}
      \begin{enumerate}
      \item Enter the function \command{f(x,y,z):=x+2y-log(z)+4} in the \field{Input Bar} of the \field{CAS View}.
      \item To plot the graph of the surface, enter the expression \command{f(x,y,z)=0} in the \field{Input Bar} and activate the \field{3D Graphics View}.
      \item To plot the point, enter the point \command{(0,-2,1)} in the \field{Input Bar}  and click the circle to the left of this expression.
      \item To compute the gradient, enter the expression \command{f'(x,y,z):=(Derivative(f,x), Derivative(f,y), Derivative(f,z))} in the \field{Input Bar}.
      \item To plot the normal line, enter the expression \command{n(t):=(0,-2,1)+f'(0,-2,1)t} in the \field{Input Bar}.
      \item To plot the normal plane, enter the expression \command{((x,y,z)-(0,-2,1))f'(0,-2,1)=0} in the \field{Input Bar} and click the circle to the left of this expression.
      \end{enumerate}
      \end{indication}

      % \item La ecuación $x+y-2e^y+2=0$ define implícitamente una función $y=f(x)$ alrededor del punto $(0,0)$. Calcular
      % $f'(0)$.
      % \begin{indication}
      % \begin{enumerate}
      % \item Introducir la expresión \command{x+y-2\$e\^{}y+2}.
      % \item Hacer clic sobre el botón \button{Hallar una derivada}.
      % \item En el cuadro de diálogo que aparece seleccionar la variable $x$ y hacer clic en el botón \button{Simplificar}. 
      % \item Seleccionar de nuevo la expresión inicial.
      % \item Hacer clic sobre el botón \button{Hallar una derivada}.
      % \item En el cuadro de diálogo que aparece seleccionar la variable $y$ y hacer clic en el botón \button{Simplificar}.
      % \item Introducir la expresión \command{-\$i/\$j} donde \command{\$i} es la etiqueta de la expresión de la derivada
      % parcial with respect to $x$ y \command{\$j} es la etiqueta de la expresión de the partial derivative with respect to $y$.
      % \item Hacer clic sobre el botón \button{Sustituir}.
      % \item En el cuadro de diálogo que aparece, seleccionar $x$ e introducir el valor $0$, seleccionar $y$ e
      % introducir el valor $0$, y hacer clic en el botón \button{Simplificar}.
      % \end{enumerate}
      % \end{indication}

\item Compute directional derivative of the function $h(x,y)= 3x^2+y$ at the point $(0,0)$, along the vector $(1,1)$.
      \begin{indication}
      \begin{enumerate}
      \item Enter the function \command{h(x,y):=3x\^{}2+y} in the \field{Input Bar} of the \field{CAS View}.
      \item To compute the partial derivative with respect to $x$, enter the command \command{h'\_x(x,y):= Derivative(h, x)} in the \field{Input Bar}.
      \item To compute the partial derivative with respect to $y$, enter the command \command{h'\_y(x,y):= Derivative(h, y)} in the \field{Input Bar}.
      \item To compute the gradient, enter the command \command{h'(x,y):= (h'\_x, h'\_y}) in the \field{Input Bar}.
      \item To compute the directional derivative at the point $(0,0)$ along the vector $(1,1)$, enter the command \command{h'(0,0)UnitVector((1,1))}.
      \end{enumerate}
      \end{indication}

\item Given the function $f(x,y)=x^3+y^3-3xy$:
      \begin{enumerate}
      \item Plot its graph.
            Looking at the graph, can you determine the relative extrema of $f$?
            \begin{indication}
            Enter the function \command{f(x,y):=x\^{}3+y\^{}3-3x*y} in the \field{Input Bar} of the \field{CAS View} and activate the \field{3D Graphics View}.
            \end{indication}

      \item Compute critical points of $f$.
            \begin{indication}
            \begin{enumerate}
            \item To compute the partial derivative with respect to $x$, enter the command \command{f'\_x(x,y):= Derivative(f, x)} in the \field{Input Bar}.
            \item To compute the partial derivative with respect to $y$, enter the command \command{f'\_y(x,y):= Derivative(f, y)} in the \field{Input Bar}.
            \item To compute the gradient, enter the command \command{f'(x,y):= (f'\_x, f'\_y} in the \field{Input Bar}.
            \item To get the critical points, enter the command \command{Solve(f'(x,y)=(0,0))} in the \field{Input Bar}.
            \end{enumerate}
            \end{indication}

      \item Determine the relative extrema and the saddle points of $f$.
            \begin{indication}
            \begin{enumerate}
            \item To compute the second order partial derivative $\frac{\partial\^2 f}{\partial x^2}$, enter the command \command{f''\_\{xx\}(x,y):= Derivative(f'\_x, x)} in the \field{Input Bar}.
            \item To compute the second order partial derivative $\frac{\partial\^2 f}{\partial y\partial x}$, enter the command \command{f''\_\{xy\}(x,y):= Derivative(f'\_x, y)} in the \field{Input Bar}.
            \item To compute the second order partial derivative $\frac{\partial\^2 f}{\partial x\partial y}$, enter the command \command{f''\_\{yx\}(x,y):= Derivative(f'\_y, x)} in the \field{Input Bar}.
            \item To compute the second order partial derivative $\frac{\partial\^2 f}{\partial y^2}$, enter the command \command{f''\_\{yy\}(x,y):= Derivative(f'\_y, y)} in the \field{Input Bar}.
            \item To compute the Hessian matrix, enter the command \command{f''(x,y):=\{\{f''\_\{xx\}, f''\_\{yx\}\}, \{f''\_\{xy\}, f''\_\{yy\}\}\}} in the \field{Input Bar}.
            \item To compute the Hessian, enter the command \command{H(x,y):=Determinant(f'')} in the \field{Input Bar}.
            \item To compute the Hessian at the critical point $(0,0)$ enter the command \command{H(0,0)} in the \field{Input Bar}.
                  Since the hessian is negative, there is a saddle point at $(0,0)$.
            \item To compute the Hessian at the critical point $(1,1)$ enter the command \command{H(1,1)} in the \field{Input Bar}.
                  Since the hessian is positive, there is a saddle point at $(1,1)$.
            \item Enter the command \command{f''\_\{xx\}(1,1)} in the \field{Input Bar}. Since this second derivative is positive, there is a local minimum at $(1,1)$.
            \end{enumerate}
            \end{indication}
      \end{enumerate}

\end{enumerate}


\section{Proposed exercises}
\begin{enumerate}[leftmargin=*]
\item A spaceship, traveling near the sun, is in trouble.
      The temperature at position $(x,y,z)$ is given by
      \[T(x,y,z)=\mbox{e}^{-x^2-2y^2-3z^2},\]
      where the variables are measured
      in thousands of kilometers, and we assume the sun is at position $(0,0,0)$.
      If the ship is at position $(1,1,1)$, find the direction in which it should move so that the temperature will decrease as fast as possible.

\item Compute the gradient, the Hessian matrix and the Hessian of the function
      \[
      g(x,y,z) = \frac{x}{\sqrt{x^2+y^2+z^2}^3}
      \]
      at the point $(1,1,1)$ and at the point $(0,3,4)$.

\item Determine the points of the ellipsoid $S: x^2+2y^2+z^2=1$ where the tangent plane is parallel to the plane $\Pi:
      x-y+2z^2=0$.

\item Determine the relative extrema of the function
      \[
      f(x)=-\frac{y}{9+x^2+y^2}.
      \]

\item Compute the directional derivative of the scalar field $f(x,y,z)=x^2-y^2+xyz^3-zx$ at the point $(1,2,3)$ along the vector $(1,-1,0)$.
\end{enumerate}
